if(typeof SubtablePermission=="undefined"){SubtablePermission={};}SubtablePermission.init=function(){if(!(CustomForm.subFileJsonType)){$("[type='subtable']").each(function(){var subTable=$(this),right=subTable.attr("right");if(!right){right="r";}else{right=right.toLowerCase();}if(right!="w"&&right!="b"){$("a.add,a.link",subTable).remove();$("input:visible,textarea:visible,select:visible",subTable).each(function(){var me=$(this);var isSelect=me.is("select");var isCheckboxOrRadio=false;var type=me.attr("type");if(type=="checkbox"||type=="radio"){isCheckboxOrRadio=true;}var val="";var validRule=me.attr("validate");if(validRule!=null&&validRule!=""&&"undefined"!=validRule.toLowerCase()){var json=eval("("+validRule+")");if(json.isWebSign){val='<input name="'+me.attr("name")+'" type="hidden" validate="{\'isWebSign\':true}" value="'+me.val()+'" />';}}if(isSelect){val+=selectValue(me);}else{if(isCheckboxOrRadio){val+="";}else{val+=me.val();}}me.before(val);me.remove();});}});}};var selectValue=function(a){var c="";var d=a.attr("selectquery");var f="";if(d!=undefined&&d!=null){d=d.replaceAll("'",'"');f=JSON2.parse(d);}else{f="";d="";}var e=a.attr("val");if(e==undefined||e==null&&e.length<=0){e="";}var b=f.search;if(b=="1"){c="<span selectvalue="+e+" selectquery="+d+"><lable></lable></span>";}else{c=e;}return c;};SubtablePermission.subRequired=function(){var b=true;var a=$("div[type='subtable']");if($.isEmptyObject(a)||a.length==0){return true;}if($.isEmpty(a)){return true;}a.each(function(){var e=$(this).is(":visible");if(!e){return true;}var c=$(this).attr("right");if($.isEmpty(c)){c="r";}else{c=c.toLowerCase();}if(c!="b"){return true;}var d=$(this).find("[formtype]:visible");if($.isEmpty(d)||$.isEmptyObject(d)||d.length==0){b=false;if(!($(this).hasClass("validError"))){$(this).addClass("validError");}return false;}});return b;};SubtablePermission.checkSubData=function(a){var b=false;$("input:text[name^='s:'],input[type='hidden'][name^='s:'],textarea[name^='s:'],select[name^='s:']",a).each(function(){var c=$(this).val();if(!$.isEmpty(c)){b=true;return false;}});$("input:checkbox:checked",a).each(function(){var c=$(this).val();if(!$.isEmpty(c)){b=true;return false;}});$("input:radio",a).each(function(){var c=$(this).val();if($(this).attr("checked")!=undefined){b=true;return false;}});return b;};