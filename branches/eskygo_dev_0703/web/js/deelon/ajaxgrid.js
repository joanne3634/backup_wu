$(function(){$("a.link.search.ajax").unbind("click");});function goPageAjax(c,d,b){var a=$("#_nav"+b).attr("href");a=replacecurrentPage(a,d,b);a=replagePageSize(a,$("#oldPageSize"+b).val(),b);a=replageOldPageSize(a,$("#oldPageSize"+b).val(),b);updateAjax(c,a);}function firstAjax(b,a){goPageAjax(b,1,a);}function lastAjax(c,b){var a=parseInt($("#totalPage"+b).val());if(a<=0){return;}goPageAjax(c,a,b);}function previousAjax(c,b){var a=parseInt($("#currentPage"+b).val());a-=1;if(a<1){a=1;}goPageAjax(c,a,b);}function nextAjax(d,c){var b=parseInt($("#currentPage"+c).val());var a=parseInt($("#totalPage"+c).val());if(a<=0){return;}b+=1;if(b>a){b=a;}goPageAjax(d,b,c);}function changePageSizeAjax(d,c){var b=$("#_nav"+c).attr("href");b=replagePageSize(b,d.value,c);b=replacecurrentPage(b,$("#currentPage"+c).val(),c);var a=$(d).closest("div[ajax='ajax']");updateAjax(d,b);}function jumpToAjax(c,b){var a=$("#navNum"+b).val();var d=/^[1-9]\d*$/;if(d.test(a)){goPageAjax(c,a,b);}else{$.ligerDialog.error("非法的页码!");$("#navNum"+b).focus();}}function refreshAjax(c,b){var a=b.indexOf("#");if(a!=-1){b=b.substring(0,a);}updateAjax(c,b);}function linkAjax(b){var c=$(b);var a=c.attr("action");updateAjax(b,a);}function handlerSearchAjax(d){var c=$(d).closest("div.panel-top").find("form[name='searchForm']");var b=c.valid();if(!b){$.ligerDialog.warn("请检查输入查询条件是否有效！");return;}var a=c.attr("action");updateAjax(d,a);}function updateAjax(f,b){var d=$("div.panel-top").find("form[name='searchForm']");var g=serializeObject(d);var a=$(f).closest("div[ajax='ajax']");var c=a.attr("displayId");var e=a.attr("filterKey");g.__displayId=c;g.__filterKey__=e;$.ligerDialog.waitting("加载中...");$.post(b,g,function(h){$.ligerDialog.closeWaitting();if(h.success){a.replaceWith(h.html);initReplaceHtml();}else{$.ligerDialog.err($lang.tip.msg,"出错了",h.msg);}});}function initReplaceHtml(){handleAjaxSearchKeyPress();initDisplaytag();$.initRowOps();$.initAbsoulteInTop();$.initFoldBox();try{Export.initExportMenu();}catch(a){}}function handleAjaxSearchKeyPress(){$(".panel-search :input").keypress(function(b){if(b.keyCode==13){$("a.link.ajaxSearch").click();}else{if(b.keyCode==27){var a=$("#searchForm");if(a){a[0].reset();}}}});}function serializeObject(c){var d={};var b=$(c).serializeArray();$.each(b,function(){if(d[this.name]){if(!d[this.name].push){d[this.name]=[d[this.name]];}d[this.name].push(this.value||"");}else{d[this.name]=this.value||"";}});return d;}function openLinkDialog(c){c=c||{};var e=c.scope||this;width=c.width||800,height=c.height||600,isFull=c.isFull||false,isStart=c.isStart||false;if(isFull){height=screen.availHeight-35;width=screen.availWidth-5;}if(isStart){$.ligerDialog.warn("请先绑定流程！");return;}var a="dialogWidth="+width+"px;dialogHeight="+height+"px;help=0;status=0;scroll=1;center=1";var b=$(e).attr("action");b=b.getNewUrl();var d=window.showModalDialog(b,{},a);if(d!=undefined){location.href=location.href.getNewUrl();}}function datePicker(b,a){if("yyyy-MM-dd"==a){WdatePicker({dateFmt:"yyyy-MM-dd",alwaysUseStartDate:true});}else{WdatePicker({dateFmt:"yyyy-MM-dd HH:mm:ss",alwaysUseStartDate:true});}$(b).blur();}function linkSortAjax(g,f){var h=$(g);var d=h.attr("action");var c=h.attr("sort");var e="DESC";var b=$("#sortField"+f).val();var a=$("#orderSeq"+f).val();if(c==b){if(a=="DESC"){e="ASC";}}d=replaceOrderSeq(d,e,f);d=replaceSortField(d,c,f);updateAjax(g,d);}function replaceSortField(d,b,f){var c=d.indexOf("#");if(c!=-1){d=d.substring(0,c);}var a=f+"s";var e=new RegExp(a+"=\\w*");if(e.test(d)){d=d.replace(e,a+"="+b);}else{if(d.indexOf("?")!=-1){d+="&"+a+"="+b;}else{d+="?"+a+"="+b;}}return d;}function replaceOrderSeq(b,c,f){var a=b.indexOf("#");if(a!=-1){b=b.substring(0,a);}var e=f+"o";var d=new RegExp(e+"=\\w*");if(d.test(b)){b=b.replace(d,e+"="+c);}else{if(b.indexOf("?")!=-1){b+="&"+e+"="+c;}else{b+="?"+e+"="+c;}}return b;}