if(typeof Export=="undefined"){Export={};}Export.initExportMenu=function(){var a={width:150,items:[{text:"导出全部数据",click:function(){Export.exportExcel(this,0);}},{text:"导出选中数据",click:function(){Export.exportExcel(this,1);}},{text:"导出当前页数据",click:function(){Export.exportExcel(this,2);}}]};$("div.exportMenu").ligerMenuBar({items:[{text:'<a href="#" class="link export"><span></span>导出&nbsp;&nbsp;</a>',menu:a}]});$("div.exportMenu").removeClass("l-menubar");$("div.l-menubar-item-down").css("right","6px");$("div.l-menubar-item").css("padding-right","0");};var exportDialog=null;Export.setExportField=function(c,a){var b="";$('input[type="checkbox"][class="pk"]:checked').each(function(){b+=$(this).val()+",";});if(b!=""){b=b.substring(0,b.length-1);}if(a==1&&b==""){alert("请选择导出的！");return;}if(exportDialog==null){Export.initExportDialog();exportDialog=$.ligerDialog.open({title:"导出字段",target:$("#exportField"),width:400,height:250,buttons:[{text:"导出",onclick:function(){Export.exportExcel(c,a,b);}},{text:"取消",onclick:function(e,d){d.hide();}}]});}exportDialog.show();};Export.initExportDialog=function(){Export.handlerCheckAll();};Export.handlerCheckAll=function(){$("#checkFieldAll").click(function(){var a=$(this).attr("checked");if(a==undefined){Export.checkFieldAll(false);}else{Export.checkFieldAll(true);}});};Export.checkFieldAll=function(a){$("input[type='checkbox'][class='field']").each(function(){$(this).attr("checked",a);});};Export.exportExcel=function(h,j){var m=$(h),g={};var r="";$('input[type="checkbox"][class="pk"]:checked').each(function(){r+=$(this).val()+",";});if(r!=""){r=r.substring(0,r.length-1);}if(j==1&&r==""){alert("请选择导出的！");return;}var k=$(".panel-page");var f=k.find("#tableIdCode").val(),e=k.find("#currentPage"+f),l=k.find("#oldPageSize"+f),i=k.find("#totalPage"+f);if(j==2&&i.val()<=0){alert("当前页没有记录！");return;}var d=$("div.panel-top").find("form[name='searchForm']");g=serializeObject(d);var a=$("div[ajax='ajax']");var c=a.attr("displayId");var o=a.attr("filterKey");g.__displayId__=c;g.__filterKey__=o;g.p=e.val();g.z=l.val();g.oz=l.val();g.__exportIds__=r;g.__exportType__=j;var b=$("#exportForm");b.empty();for(var q in g){var n=$("<input type='hidden' name='"+q+"' value='"+g[q]+"'/>");b.append(n);}b.submit();};