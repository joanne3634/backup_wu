GlobalType=function(d,b,c){this.glTypeTree=null;this.currentNode=null;this.conf=c;this.catKey=d;this.divId=b;var a=this;this.loadGlobalTree=function(){var f={data:{key:{name:"typeName"},simpleData:{enable:true,idKey:"typeId",pIdKey:"parentId"}},callback:{onClick:this.clickHandler,onRightClick:this.rightClickHandler}};var e=__ctx+"/platform/system/globalType/getByCatKey.ht";if(c.url){e=c.url;}var g={catKey:this.catKey};$.post(e,g,function(q){for(var m=0;m<q.length;m++){var k=q[m];if(k.parentId==0){k.icon=__ctx+"/styles/default/images/icon/root.png";k.isRoot=1;}}a.glTypeTree=$.fn.zTree.init($("#"+a.divId),f,q);var l=a.conf.expandByDepth;if(l!=null&&l>=0){var h=a.glTypeTree.getNodesByFilter(function(i){return(i.level==l);});if(h.length>0){for(var p=0;p<h.length;p++){a.glTypeTree.expandNode(h[p],false,false);}}}else{a.glTypeTree.expandAll(true);}var o=$(".tree-toolbar").height();var j=$("#defLayout").height();var n=(parseInt(j)-parseInt(o)*3)+"px";$("#glTypeTree").css({"height":n});});};this.rightClickHandler=function(e,g,f){if(a.conf.onRightClick){a.conf.onRightClick(e,g,f);}};this.clickHandler=function(e,g,f){a.currentNode=f;if(a.conf.onClick){a.conf.onClick(f);}};this.treeExpandAll=function(e){a.glTypeTree.expandAll(e);};this.delNode=function(){var f=a.currentNode.typeId;if(f!=0){var e=__ctx+"/platform/system/globalType/del.ht";var g={typeId:f};$.post(e,g,function(h){a.loadGlobalTree();$.ligerDialog.success("成功删除!","提示信息");});}};this.openGlobalTypeDlg=function(h,k){var i=a.currentNode.typeId;var f=a.currentNode.isRoot;var g=__ctx+"/platform/system/globalType/dialog.ht";if(h){if(f){g+="?parentId="+i+"&isRoot=1";}else{g+="?parentId="+i+"&isRoot=0";}}else{g+="?typeId="+i;}if(k){g+="&isPrivate=1";}var e="dialogWidth:500px;dialogHeight:250px";g=g.getNewUrl();var j=window.showModalDialog(g,"",e);a.loadGlobalTree();};this.sortNode=function(){var g=a.currentNode.typeId;var f=__ctx+"/platform/system/globalType/sortList.ht?parentId="+g;var e="dialogWidth:600px;dialogHeight:300px";f=f.getNewUrl();var h=window.showModalDialog(f,"",e);a.loadGlobalTree();};};